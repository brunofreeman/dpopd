TODO: fix .dat reading
TODO: add typing